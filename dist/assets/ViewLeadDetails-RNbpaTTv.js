import{r as o,m as Q,j as e,h as W,G as n,v as _}from"./index-DtMJePn8.js";import{b as k,B as M}from"./AuthAction-qyCv6AN3.js";import{C as X,a as Z}from"./CInputGroupText-DYtJMnto.js";import{C as D,a as ee,b as V,c as i,d as se,e as c}from"./CTable-BcBRXgdI.js";import{C as E}from"./CTooltip-D-TYCa-y.js";import{c as te,a as ae}from"./cil-trash-prAk5aip.js";import{C as le,a as x}from"./CPaginationItem-CBzJTxOD.js";import{C as oe,a as ne,b as re}from"./CToastHeader-JmaAU95n.js";import{C as ie,a as ce,b as de}from"./CModalHeader-e1aLBSYs.js";import"./getRTLPlacement-CbZ5HTfU.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";import"./DefaultLayout-CTh0jsZ3.js";import"./CContainer-CwkQQ0mD.js";import"./cil-user-Dlmw-Gem.js";const Pe=()=>{const[f,m]=o.useState([]),[y,w]=o.useState(!0),[h,I]=o.useState(""),[r,N]=o.useState(1),[L,u]=o.useState(!1),[A,B]=o.useState(null),[F,$]=o.useState(""),[j,S]=o.useState(!1),g=8,P=Q(),H=f.length,l=Math.ceil(H/g),v=r*g,O=v-g,G=f.slice(O,v),p=s=>N(s),R=()=>{const s=[];let t=Math.max(1,r-Math.floor(2.5)),C=Math.min(l,t+5-1);C-t+1<5&&(t=Math.max(1,C-5+1));for(let d=t;d<=C;d++)s.push(e.jsx(x,{onClick:()=>p(d),active:d===r,children:d},d));return l>5&&C<l&&(s.push(e.jsx(x,{disabled:!0,children:"..."},"ellipsis")),s.push(e.jsx(x,{onClick:()=>p(l),children:l},l))),s};console.log(j);const b=async()=>{var s,a;w(!0);try{const t=await k.get(`${M}viewproposalclient`);console.log((s=t==null?void 0:t.data)==null?void 0:s.data),t.status?(m((a=t==null?void 0:t.data)==null?void 0:a.data),S(!1)):m([])}catch(t){console.error("Error fetching clients:",t),m([])}finally{w(!1)}};o.useEffect(()=>{b()},[]);const Y=()=>{if(h.trim()==="")b();else{const s=f.filter(a=>a.name.toLowerCase().includes(h.toLowerCase())||a.phone.includes(h)||a.source.toLowerCase().includes(h.toLowerCase()));m(s)}N(1)},K=s=>{P(`/editleadfollowup/${s}`)};console.log(j);const U=async s=>{try{(await k.post(`${M}deletePerposal?id=${s}`)).data.status&&($("Your data has been deleted successfully!"),S(!0),b())}catch(a){console.error("There was an error deleting the client:",a)}},q=s=>{B(s),u(!0)},z=()=>{U(A),u(!1)},J=()=>{u(!1)},T=s=>{P(`/sendemail/${s}`)};return e.jsxs("div",{className:y?"":"common_box_shadow list_parent_div",children:[y?e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(W,{color:"primary"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex justify-content-between flex-column flex-sm-row mb-5 mt-2",children:[e.jsxs(X,{className:"main_search mb-5 mb-lg-1",children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by Name, Phone or Source",value:h,onChange:s=>I(s.target.value)}),e.jsx(Z,{children:e.jsx(n,{color:"primary",style:{height:"40px"},onClick:Y,children:"Search"})})]}),e.jsx(n,{className:"btn-xs",color:"success",style:{height:"40px"},children:"Send Emails for Confirmation"})]}),e.jsxs(D,{bordered:!0,className:"mb-5 lead_table",children:[e.jsx(ee,{className:"",children:e.jsxs(V,{className:"border",color:"light",children:[e.jsx(i,{scope:"col",children:"Date Of entry"}),e.jsx(i,{scope:"col",children:"Source"}),e.jsx(i,{scope:"col",children:"Name"}),e.jsx(i,{scope:"col",children:"Phone"}),e.jsx(i,{scope:"col",style:{width:"300px"},children:"Interested Shoot"}),e.jsx(i,{scope:"col",children:"Proposal Status"}),e.jsx(i,{scope:"col",children:"Followup Status"}),e.jsx(i,{scope:"col",children:"Action"})]})}),e.jsx(se,{children:G.map(s=>e.jsxs(V,{children:[e.jsx(c,{children:s.datetime}),e.jsx(c,{children:s.source}),e.jsx(c,{children:s.name}),e.jsx(c,{children:s.phone}),e.jsx(c,{children:s.interestedshoot}),e.jsx(c,{children:e.jsxs("div",{className:"d-flex justify-content-center  flex-column flex-sm-row gap-2",children:[s.mailsent?e.jsxs(n,{id:"view_btn",onClick:()=>T(s.id),children:["View ",e.jsxs("small",{children:["Sent (",s.mailsent,")"]})]}):e.jsx(n,{id:"notsetyet_btn",children:"Not sent Yet"}),e.jsxs(n,{id:"sendnow_btn",onClick:()=>T(s.id),children:["Send ",s.mail?"Again":"Now"," "]})]})}),e.jsx(c,{children:e.jsx("div",{className:"d-flex justify-content-center gap-2 text-center",children:s.status=="Completed"?e.jsx("span",{style:{background:s.status=="Completed"?"#1b9e3e":"	#f9b115"},className:"custom_table_span",children:s.status}):e.jsx("span",{className:"btn btn-warning btn-xs"})})}),e.jsx(c,{children:e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx(E,{content:"Edit-Followup",children:e.jsx(n,{color:"primary",onClick:()=>K(s.id),children:e.jsx(_,{icon:te})})}),e.jsx(E,{content:"Delete",children:e.jsx(n,{color:"danger",onClick:()=>q(s.id),children:e.jsx(_,{icon:ae})})})]})})]},s.id))})]}),e.jsxs(le,{className:"d-flex justify-content-center justify-content-lg-end mt-3 mb-2","aria-label":"Page navigation example",children:[e.jsx(x,{"aria-label":"Previous",onClick:()=>r>1&&p(r-1),children:e.jsx("span",{"aria-hidden":"true",children:"«"})}),R(),l>1&&r<l&&e.jsx(x,{"aria-label":"Next",onClick:()=>r<l&&p(r+1),children:e.jsx("span",{"aria-hidden":"true",children:"»"})})]})]}),j&&e.jsxs(oe,{visible:j,autohide:!0,className:"delete_tost",children:[e.jsx(ne,{className:"dtoast_header",children:"Success"}),e.jsx(re,{className:"dtoast_body",children:F})]}),e.jsxs(ie,{className:"centered-modal",visible:L,onClose:()=>u(!1),children:[e.jsx(ce,{children:"Are you sure you want to delete this lead?"}),e.jsxs(de,{children:[e.jsx(n,{color:"secondary",onClick:J,children:"Cancel"}),e.jsx(n,{color:"danger",onClick:z,children:"OK"})]})]})]})};export{Pe as default};
