import{r as l,m as W,j as e,h as X,H as n,v as _,ab as k,ac as M}from"./index-CZW5Qv0I.js";import{C as Z,a as ee}from"./CInputGroupText-DarANVSr.js";import{C as se,a as te,b as V,c as r,d as ae,e as c}from"./CTable-VyADZ8P_.js";import{C as E}from"./CTooltip-D9kfusRe.js";import{c as le,a as oe}from"./cil-trash-prAk5aip.js";import{C as ne,a as u}from"./CPaginationItem-BOZ8q3n7.js";import{C as ie,a as re,b as ce}from"./CToastHeader-ClRd2oDw.js";import{C as de,a as he}from"./CModalFooter-C39djyb6.js";import{C as xe}from"./CModalHeader-BiVSEg3l.js";import"./getRTLPlacement-CvoR8nNH.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";import"./DefaultLayout-BXLi4BxZ.js";import"./CContainer-D4F994G-.js";import"./cil-user-Dlmw-Gem.js";const Te=()=>{const[f,x]=l.useState([]),[I,L]=l.useState([]),[b,y]=l.useState(!0),[m,A]=l.useState(""),[i,w]=l.useState(1),[F,j]=l.useState(!1),[H,$]=l.useState(null),[B,O]=l.useState(""),[p,N]=l.useState(!1),g=8,S=W(),R=f.length,o=Math.ceil(R/g),P=i*g,G=P-g,Y=f.slice(G,P),C=s=>w(s),D=()=>{const s=[];let d=Math.max(1,i-Math.floor(2.5)),t=Math.min(o,d+5-1);t-d+1<5&&(d=Math.max(1,t-5+1));for(let h=d;h<=t;h++)s.push(e.jsx(u,{onClick:()=>C(h),active:h===i,children:h},h));return o>5&&t<o&&(s.push(e.jsx(u,{disabled:!0,children:"..."},"ellipsis")),s.push(e.jsx(u,{onClick:()=>C(o),children:o},o))),s};console.log(p);const v=async()=>{var s,a,d;y(!0);try{const t=await k.get(`${M}viewproposalclient`);console.log((s=t==null?void 0:t.data)==null?void 0:s.data),t.status?(x((a=t==null?void 0:t.data)==null?void 0:a.data),L((d=t==null?void 0:t.data)==null?void 0:d.data),N(!1)):x([])}catch(t){console.error("Error fetching clients:",t),x([])}finally{y(!1)}};l.useEffect(()=>{v()},[]);const K=()=>{if(m.trim()==="")x(I);else{const s=f.filter(a=>a.name.toLowerCase().includes(m.toLowerCase())||a.phone.includes(m)||a.source.toLowerCase().includes(m.toLowerCase()));x(s)}w(1)},U=s=>{S(`/editleadfollowup/${s}`)};console.log(p);const q=async s=>{try{(await k.post(`${M}deletePerposal?id=${s}`)).data.status&&(O("Your data has been deleted successfully!"),N(!0),v())}catch(a){console.error("There was an error deleting the client:",a)}},z=s=>{$(s),j(!0)},J=()=>{q(H),j(!1)},Q=()=>{j(!1)},T=s=>{S(`/sendemail/${s}`)};return e.jsxs("div",{className:b?"":"common_box_shadow list_parent_div",children:[b?e.jsx("div",{className:"d-flex justify-content-center mt-5",children:e.jsx(X,{color:"primary"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex justify-content-between flex-column flex-sm-row mb-5 mt-2",children:[e.jsxs(Z,{className:"main_search mb-5 mb-lg-1",children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by Name, Phone or Source",value:m,onChange:s=>A(s.target.value)}),e.jsx(ee,{children:e.jsx(n,{color:"primary",style:{height:"40px"},onClick:K,children:"Search"})})]}),e.jsx(n,{className:"btn-xs",color:"success",style:{height:"40px"},children:"Send Emails for Confirmation"})]}),e.jsxs(se,{bordered:!0,className:"mb-5 lead_table",children:[e.jsx(te,{className:"",children:e.jsxs(V,{className:"border",color:"light",children:[e.jsx(r,{scope:"col",children:"Date Of entry"}),e.jsx(r,{scope:"col",children:"Source"}),e.jsx(r,{scope:"col",children:"Name"}),e.jsx(r,{scope:"col",children:"Phone"}),e.jsx(r,{scope:"col",style:{width:"300px"},children:"Interested Shoot"}),e.jsx(r,{scope:"col",children:"Proposal Status"}),e.jsx(r,{scope:"col",children:"Followup Status"}),e.jsx(r,{scope:"col",children:"Action"})]})}),e.jsx(ae,{children:Y.map(s=>e.jsxs(V,{children:[e.jsx(c,{children:s.datetime}),e.jsx(c,{children:s.source}),e.jsx(c,{children:s.name}),e.jsx(c,{children:s.phone}),e.jsx(c,{children:s.interestedshoot}),e.jsx(c,{children:e.jsxs("div",{className:"d-flex justify-content-center  flex-column flex-sm-row gap-2",children:[s.mailsent?e.jsxs(n,{id:"view_btn",onClick:()=>T(s.id),children:["View ",e.jsxs("small",{children:["Sent (",s.mailsent,")"]})]}):e.jsx(n,{id:"notsetyet_btn",children:"Not sent Yet"}),e.jsxs(n,{id:"sendnow_btn",onClick:()=>T(s.id),children:["Send ",s.mail?"Again":"Now"," "]})]})}),e.jsx(c,{children:e.jsx("div",{className:"d-flex justify-content-center gap-2 text-center",children:s.status=="Completed"?e.jsx("span",{style:{background:s.status=="Completed"?"#1b9e3e":"	#f9b115"},className:"custom_table_span",children:s.status}):e.jsx("span",{className:"btn btn-warning btn-xs"})})}),e.jsx(c,{children:e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx(E,{content:"Edit-Followup",children:e.jsx(n,{color:"primary",onClick:()=>U(s.id),children:e.jsx(_,{icon:le})})}),e.jsx(E,{content:"Delete",children:e.jsx(n,{color:"danger",onClick:()=>z(s.id),children:e.jsx(_,{icon:oe})})})]})})]},s.id))})]}),e.jsxs(ne,{className:"d-flex justify-content-center justify-content-lg-end mt-3 mb-2","aria-label":"Page navigation example",children:[e.jsx(u,{"aria-label":"Previous",onClick:()=>i>1&&C(i-1),children:e.jsx("span",{"aria-hidden":"true",children:"«"})}),D(),o>1&&i<o&&e.jsx(u,{"aria-label":"Next",onClick:()=>i<o&&C(i+1),children:e.jsx("span",{"aria-hidden":"true",children:"»"})})]})]}),p&&e.jsxs(ie,{visible:p,autohide:!0,className:"delete_tost",children:[e.jsx(re,{className:"dtoast_header",children:"Success"}),e.jsx(ce,{className:"dtoast_body",children:B})]}),e.jsxs(de,{className:"centered-modal",visible:F,onClose:()=>j(!1),children:[e.jsx(xe,{children:"Are you sure you want to delete this lead?"}),e.jsxs(he,{children:[e.jsx(n,{color:"secondary",onClick:Q,children:"Cancel"}),e.jsx(n,{color:"danger",onClick:J,children:"OK"})]})]})]})};export{Te as default};
